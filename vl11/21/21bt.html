<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài 21: Tụ Điện - Trắc Nghiệm & Tự Luận</title>
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/tuibx25/images/bx/favicon.ico" type="image/x-icon">
    
    <!-- BẢO MẬT: Ngăn chặn các hành vi không mong muốn -->
    <script>
        // Ngăn chặn menu chuột phải
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn phím tắt (Ctrl+U, Ctrl+S, Ctrl+P, F12, etc.)
        document.addEventListener('keydown', function(e) {
            // Ctrl+U (View Source)
            if (e.ctrlKey && e.keyCode === 85) e.preventDefault();
            // Ctrl+S (Save)
            if (e.ctrlKey && e.keyCode === 83) e.preventDefault();
            // Ctrl+P (Print)
            if (e.ctrlKey && e.keyCode === 80) e.preventDefault();
            // F12 (Developer Tools)
            if (e.keyCode === 123) e.preventDefault();
            // Ctrl+Shift+I (Developer Tools)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 73) e.preventDefault();
            // Ctrl+Shift+J (Console)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 74) e.preventDefault();
            // Ctrl+Shift+C (Inspector)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 67) e.preventDefault();
        });
        
        // Ngăn chặn kéo thả hình ảnh
        document.addEventListener('dragstart', function(e) {
            if (e.target.tagName === 'IMG') e.preventDefault();
        });
        
        // Ngăn chặn sao chép văn bản
        document.addEventListener('copy', function(e) {
            e.preventDefault();
            alert('Không cho phép sao chép nội dung!');
        });
        
        // Ngăn chặn cắt
        document.addEventListener('cut', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn dán
        document.addEventListener('paste', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn chọn văn bản
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn bôi đen văn bản
        document.addEventListener('mousedown', function(e) {
            if (e.detail > 1) e.preventDefault(); // Ngăn double-click chọn
        });
    </script>
    
    <!-- BẢO MẬT: CSS để chống in ấn -->
    <style>
        @media print {
            * {
                display: none !important;
            }
            body:before {
                content: "Không cho phép in trang này!";
                display: block !important;
                font-size: 24px;
                text-align: center;
                margin-top: 100px;
                color: #000000;
            }
        }
    </style>
    
    <!-- MathJax để hiển thị công thức toán -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    
    <style>
        /* Reset và cài đặt chung */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Standard */
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.4;
            color: #000000; /* Màu chữ đen */
            background-color: #FDF6E3;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Watermark nền - watermark đầu tiên */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: repeat;
            background-position: center;
            background-size: 400px 400px;
            opacity: 0.08;
            z-index: -1;
            pointer-events: none;
        }
        
        /* Tab điều hướng */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }
        
        .tab-btn {
            background-color: #8D6E63;
            color: white;
            border: none;
            padding: 12px 30px;
            margin: 0 5px;
            cursor: pointer;
            font-size: 1.3rem;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab-btn.active {
            background-color: #5D4037;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .tab-btn:hover {
            background-color: #6D4C41;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Tiêu đề chính */
        .main-title {
            text-align: center;
            color: #000000; /* Màu chữ đen */
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #8D6E63;
            font-size: 2.5rem;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        /* Container chính */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.92);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(93, 64, 55, 0.1);
            padding: 30px;
            position: relative;
            z-index: 1;
        }
        
        /* Watermark phủ toàn màn hình - watermark thứ hai */
        .watermark-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
        }
        
        .watermark-overlay::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: repeat;
            background-position: center;
            background-size: 200px 200px;
            opacity: 0.04;
        }
        
        /* PHẦN TRẮC NGHIỆM */
        /* Hướng dẫn */
        .instructions {
            background-color: #f9f3e9;
            border: 1px solid #8D6E63;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-size: 1.4rem;
            line-height: 1.2;
            color: #000000; /* Màu chữ đen */
        }
        
        .instructions h3 {
            color: #000000; /* Màu chữ đen */
            margin-bottom: 8px;
            font-size: 1.6rem;
            line-height: 1.1;
        }
        
        .instructions p {
            margin-bottom: 3px;
            color: #000000; /* Màu chữ đen */
        }
        
        /* Câu hỏi trắc nghiệm */
        .quiz-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .question-card {
            background-color: #faf7f2;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid #8D6E63;
            position: relative;
            overflow: hidden;
        }
        
        .question-card::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300px;
            height: 300px;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            opacity: 0.03;
            transform: translate(-50%, -50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .question-number {
            display: inline-block;
            background-color: #8B4513; /* Màu nền mới #8B4513 */
            color: white;
            width: 40px;
            height: 40px;
            text-align: center;
            line-height: 40px;
            border-radius: 50%;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.3rem;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }
        
        .question-text {
            font-weight: 600;
            font-size: 1.6rem;
            color: #000000; /* Màu chữ đen */
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 3px;
            position: relative;
            z-index: 1;
        }
        
        .option {
            padding: 6px 10px;
            background-color: white;
            border: 2px solid #BCAAA4;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            min-height: 40px;
            line-height: 1.1;
            color: #000000; /* Màu chữ đen */
        }
        
        .option:hover {
            background-color: #D7CCC8;
            border-color: #8D6E63;
            transform: translateY(-2px);
            color: #000000; /* Màu chữ đen */
        }
        
        /* Màu sắc cho câu trả lời khi được chọn */
        .option.selected {
            background-color: #C0C0C0;
            color: #000000; /* Màu chữ đen */
            border-color: #999999;
        }
        
        .option.selected:hover {
            background-color: #C0C0C0;
            border-color: #999999;
            transform: translateY(-2px);
            color: #000000; /* Màu chữ đen */
        }
        
        /* Màu sắc cho câu trả lời đúng/sai */
        .option.correct {
            background-color: rgba(46, 125, 50, 0.2);
            border-color: #2E7D32;
            color: #000000; /* Màu chữ đen */
        }
        
        .option.incorrect {
            background-color: rgba(198, 40, 40, 0.2);
            border-color: #C62828;
            color: #000000; /* Màu chữ đen */
        }
        
        .option-label {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #8B4513; /* Màu nền mới #8B4513 */
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 1.1rem;
        }
        
        /* Điều khiển trắc nghiệm */
        .quiz-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }
        
        .quiz-btn {
            padding: 15px 25px;
            font-size: 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 180px;
            color: white; /* Chữ trên nút vẫn giữ màu trắng */
        }
        
        #submitQuizBtn {
            background-color: #5D4037;
        }
        
        #submitQuizBtn:hover {
            background-color: #3E2723;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        #resetQuizBtn {
            background-color: #8D6E63;
        }
        
        #resetQuizBtn:hover {
            background-color: #6D4C41;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .result-container {
            display: none;
            background-color: #FAF3E9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            text-align: center;
            border: 2px solid #5D4037;
            position: relative;
            z-index: 1;
            color: #000000; /* Màu chữ đen */
        }
        
        .result-container::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 200px;
            height: 200px;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            opacity: 0.03;
            transform: translate(-50%, -50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .score {
            font-size: 2.5rem;
            color: #000000; /* Màu chữ đen */
            margin: 10px 0;
            font-weight: bold;
            position: relative;
            z-index: 1;
            line-height: 1;
        }
        
        .feedback {
            font-size: 1.6rem;
            margin-top: 12px;
            position: relative;
            z-index: 1;
            line-height: 1.2;
            color: #000000; /* Màu chữ đen */
        }
        
        /* PHẦN TỰ LUẬN */
        /* Nút điều khiển toàn cục tự luận */
        .essay-global-controls {
            text-align: center;
            margin: 30px 0;
            position: relative;
            z-index: 1;
        }
        
        .essay-global-btn {
            background-color: #5D4037;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2rem;
            margin: 0 10px;
            transition: background-color 0.3s;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .essay-global-btn:hover {
            background-color: #3E2723;
        }
        
        /* Phần bài tập tự luận */
        .exercise {
            margin-bottom: 40px;
            padding-bottom: 25px;
            border-bottom: 1px solid #D7CCC8;
            position: relative;
            overflow: hidden;
        }
        
        .exercise:last-child {
            border-bottom: none;
        }
        
        /* Watermark trên từng bài tập */
        .exercise::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300px;
            height: 300px;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            opacity: 0.03;
            transform: translate(-50%, -50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .question-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }
        
        .question-number-essay {
            background-color: #8B4513; /* Màu nền mới #8B4513 */
            color: white;
            font-weight: bold;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.2rem;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            line-height: 1;
        }
        
        .question-title-container {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        
        .question-title {
            color: #000000; /* Màu chữ đen */
            font-size: 1.8rem;
            font-weight: 600;
            margin-right: 20px;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .toggle-solution-btn {
            background-color: #795548;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: background-color 0.3s;
            flex-shrink: 0;
            margin-left: auto;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .toggle-solution-btn:hover {
            background-color: #5D4037;
        }
        
        .question-content {
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-left: 55px;
            position: relative;
            z-index: 1;
            line-height: 1.3;
            color: #000000; /* Màu chữ đen */
        }
        
        .summary {
            background-color: #FFECB3;
            border-left: 4px solid #FFB300;
            padding: 15px;
            margin: 15px 0 20px 55px;
            border-radius: 0 8px 8px 0;
            font-size: 1.4rem;
            position: relative;
            z-index: 1;
            line-height: 1.3;
            color: #000000; /* Màu chữ đen */
        }
        
        .summary h3, .solution h3 {
            color: #000000; /* Màu chữ đen */
            margin-bottom: 8px;
            font-size: 1.6rem;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .solution {
            background-color: #E8F5E9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 15px 0 0 55px;
            border-radius: 0 8px 8px 0;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
            z-index: 1;
            line-height: 1.3;
            color: #000000; /* Màu chữ đen */
        }
        
        /* Watermark trên phần giải */
        .solution::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 250px;
            height: 250px;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            opacity: 0.02;
            transform: translate(-50%, -50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .solution.hidden {
            display: none;
        }
        
        .solution p {
            margin-bottom: 4px;
            line-height: 1.2;
            color: #000000; /* Màu chữ đen */
        }
        
        .solution p:last-child {
            margin-bottom: 0;
            color: #000000; /* Màu chữ đen */
        }
        
        .formula {
            font-family: 'Cambria Math', serif;
            background-color: #F5F5F5;
            padding: 6px 10px;
            border-radius: 4px;
            margin: 2px 0 4px 0;
            font-size: 1.4rem;
            overflow-x: auto;
            position: relative;
            z-index: 1;
            line-height: 1.1;
            color: #000000; /* Màu chữ đen */
        }
        
        /* Giảm khoảng cách cho các phần tử đặc biệt trong solution */
        .solution strong {
            display: inline-block;
            margin-bottom: 2px;
            color: #000000; /* Màu chữ đen */
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #8D6E63;
            color: #000000; /* Màu chữ đen */
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
            line-height: 1.3;
        }
        
        footer::before {
            content: "tuibx";
            position: absolute;
            bottom: 10px;
            right: 20px;
            font-size: 1rem;
            color: rgba(0, 0, 0, 0.3); /* Màu chữ đen nhạt */
            font-weight: bold;
            font-style: italic;
            z-index: 0;
        }
        
        /* Responsive cho điện thoại */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 90%;
                line-height: 1.3;
                color: #000000; /* Màu chữ đen */
            }
            
            .main-title {
                font-size: 1.8rem;
                line-height: 1.1;
                color: #000000; /* Màu chữ đen */
            }
            
            .tab-btn {
                padding: 10px 15px;
                font-size: 1.1rem;
            }
            
            .question-content, .summary, .solution {
                padding-left: 20px;
                margin-left: 20px;
                font-size: 1.2rem;
                line-height: 1.2;
                color: #000000; /* Màu chữ đen */
            }
            
            .question-title {
                font-size: 1.4rem;
                line-height: 1.1;
                color: #000000; /* Màu chữ đen */
            }
            
            .question-number, .question-number-essay {
                width: 35px;
                height: 35px;
                font-size: 1rem;
                background-color: #8B4513; /* Màu nền mới #8B4513 cho mobile */
            }
            
            .container {
                padding: 15px;
            }
            
            .question-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .toggle-solution-btn {
                margin-top: 10px;
                align-self: flex-start;
            }
            
            .essay-global-btn, .quiz-btn {
                width: 90%;
                margin: 10px 0;
                padding: 12px;
                line-height: 1.2;
            }
            
            body::before {
                background-size: 300px 300px;
                opacity: 0.05;
            }
            
            .exercise::before {
                width: 200px;
                height: 200px;
            }
            
            .solution::before {
                width: 150px;
                height: 150px;
            }
            
            .summary h3, .solution h3 {
                font-size: 1.4rem;
                line-height: 1.1;
                color: #000000; /* Màu chữ đen */
            }
            
            .question-text {
                font-size: 1.3rem;
                margin-bottom: 8px;
                line-height: 1.1;
                color: #000000; /* Màu chữ đen */
            }
            
            .option {
                padding: 5px 8px;
                font-size: 1.2rem;
                min-height: 35px;
                line-height: 1;
                color: #000000; /* Màu chữ đen */
            }
            
            .option-label {
                width: 25px;
                height: 25px;
                line-height: 25px;
                margin-right: 8px;
                font-size: 1rem;
                background-color: #8B4513; /* Màu nền mới #8B4513 cho mobile */
            }
            
            .instructions {
                color: #000000; /* Màu chữ đen */
            }
            
            .instructions h3 {
                color: #000000; /* Màu chữ đen */
            }
            
            .instructions p {
                color: #000000; /* Màu chữ đen */
            }
            
            .result-container {
                color: #000000; /* Màu chữ đen */
            }
            
            .score {
                color: #000000; /* Màu chữ đen */
            }
            
            .feedback {
                color: #000000; /* Màu chữ đen */
            }
        }
        
        /* Responsive cho TV/màn hình lớn */
        @media (min-width: 1200px) {
            body {
                font-size: 110%;
                line-height: 1.5;
                color: #000000; /* Màu chữ đen */
            }
            
            .question-content, .summary, .solution {
                font-size: 1.6rem;
                line-height: 1.4;
                color: #000000; /* Màu chữ đen */
            }
            
            .question-title {
                font-size: 2rem;
                line-height: 1.3;
                color: #000000; /* Màu chữ đen */
            }
            
            .main-title {
                font-size: 3rem;
                line-height: 1.3;
                color: #000000; /* Màu chữ đen */
            }
            
            .container {
                padding: 40px;
            }
            
            .essay-global-btn, .quiz-btn {
                font-size: 1.4rem;
                padding: 18px 35px;
                line-height: 1.3;
            }
            
            .formula {
                font-size: 1.6rem;
                line-height: 1.2;
                color: #000000; /* Màu chữ đen */
            }
            
            body::before {
                background-size: 500px 500px;
                opacity: 0.1;
            }
            
            .question-number, .question-number-essay {
                background-color: #8B4513; /* Màu nền mới #8B4513 cho desktop */
            }
            
            .option-label {
                background-color: #8B4513; /* Màu nền mới #8B4513 cho desktop */
            }
        }
        
        /* Đảm bảo MathJax hiển thị đúng */
        .MathJax {
            font-size: 1.4rem !important;
            position: relative;
            z-index: 1;
            line-height: 1.1 !important;
            margin: 0 !important;
            color: #000000 !important; /* Màu chữ đen cho công thức toán */
        }
        
        mjx-container[jax="CHTML"] {
            display: inline-block !important;
            position: relative;
            z-index: 1;
        }
        
        /* Chú ý về màu sắc */
        .color-note {
            text-align: center;
            font-style: italic;
            color: #000000; /* Màu chữ đen */
            margin-top: 20px;
            padding: 10px;
            background-color: #FFE0B2;
            border-radius: 5px;
            font-size: 1.3rem;
            position: relative;
            z-index: 1;
            line-height: 1.3;
        }
        
        /* Đảm bảo tất cả văn bản trong phần giải thích trắc nghiệm đều màu đen */
        #quizFeedback ul li {
            color: #000000 !important;
        }
        
        #quizFeedback ul li span {
            color: #000000 !important;
        }
        
        #quizResultText p {
            color: #000000 !important;
        }
    </style>
</head>
<body>
    <!-- Watermark phủ toàn màn hình -->
    <div class="watermark-overlay"></div>
    
    <h1 class="main-title">BÀI 21: TỤ ĐIỆN - TRẮC NGHIỆM & TỰ LUẬN</h1>
    
    <!-- Tab điều hướng -->
    <div class="tabs">
        <button class="tab-btn active" data-tab="quiz-tab">TRẮC NGHIỆM (20 câu)</button>
        <button class="tab-btn" data-tab="essay-tab">TỰ LUẬN (5 bài)</button>
    </div>
    
    <!-- Container chính -->
    <div class="container">
        <!-- Phần trắc nghiệm -->
        <div id="quiz-tab" class="tab-content active">
            <div class="instructions">
                <h3>HƯỚNG DẪN LÀM BÀI TRẮC NGHIỆM</h3>
                <p>1. Đọc kỹ từng câu hỏi và chọn một đáp án đúng nhất.</p>
                <p>2. Nhấp vào đáp án để chọn. Đáp án được chọn sẽ được đánh dấu.</p>
                <p>3. Sau khi hoàn thành tất cả câu hỏi, nhấn nút "NỘP BÀI" để xem kết quả.</p>
                <p>4. Nhấn "LÀM LẠI" để thiết lập lại bài kiểm tra.</p>
            </div>
            
            <div class="quiz-container" id="quizContainer">
                <!-- Các câu hỏi trắc nghiệm sẽ được tạo bằng JavaScript -->
            </div>
            
            <div class="quiz-controls">
                <button id="submitQuizBtn" class="quiz-btn">NỘP BÀI TRẮC NGHIỆM</button>
                <button id="resetQuizBtn" class="quiz-btn">LÀM LẠI TRẮC NGHIỆM</button>
            </div>
            
            <div class="result-container" id="quizResultContainer">
                <h2>KẾT QUẢ BÀI LÀM TRẮC NGHIỆM</h2>
                <div class="score" id="quizScore">0/20</div>
                <div id="quizResultText"></div>
                <div class="feedback" id="quizFeedback"></div>
            </div>
        </div>
        
        <!-- Phần tự luận -->
        <div id="essay-tab" class="tab-content">
            <div class="essay-global-controls">
                <button id="showAllSolutionsBtn" class="essay-global-btn">HIỂN THỊ TẤT CẢ LỜI GIẢI</button>
                <button id="hideAllSolutionsBtn" class="essay-global-btn">ẨN TẤT CẢ LỜI GIẢI</button>
            </div>
            
            <!-- Bài tập tự luận 1 -->
            <div class="exercise">
                <div class="question-header">
                    <div class="question-title-container">
                        <div class="question-number-essay">1</div>
                        <h2 class="question-title">Tính điện dung và năng lượng tụ điện phẳng</h2>
                    </div>
                    <button class="toggle-solution-btn" data-target="solution-1">Hiển thị lời giải</button>
                </div>
                <div class="question-content">
                    Một tụ điện phẳng có diện tích mỗi bản là $S = 200 \, \text{cm}^2$, khoảng cách giữa hai bản là $d = 2 \, \text{mm}$, đặt trong không khí.
                    a) Tính điện dung của tụ điện.
                    b) Tích điện cho tụ đến hiệu điện thế $U = 300 \, \text{V}$. Tính điện tích và năng lượng của tụ.
                    c) Nếu ngắt tụ khỏi nguồn và nhúng vào chất điện môi lỏng có hằng số điện môi $\varepsilon = 4$, tính điện dung và hiệu điện thế mới.
                </div>
                <div class="summary">
                    <h3>Tóm tắt</h3>
                    <p>$S = 200 \, \text{cm}^2 = 2 \times 10^{-2} \, \text{m}^2$, $d = 2 \, \text{mm} = 2 \times 10^{-3} \, \text{m}$, $\varepsilon_0 = 8,85 \times 10^{-12} \, \text{F/m}$,
                    $U = 300 \, \text{V}$, $\varepsilon = 4$. Tính $C, Q, W$ và $C', U'$ sau khi nhúng điện môi.</p>
                </div>
                <div class="solution hidden" id="solution-1">
                    <h3>Lời giải</h3>
                    <p><strong>a) Tính điện dung của tụ điện trong không khí:</strong></p>
                    <p>Công thức điện dung tụ điện phẳng: $C = \frac{\varepsilon_0 S}{d}$</p>
                    <p class="formula">$$C = \frac{8,85 \times 10^{-12} \times 2 \times 10^{-2}}{2 \times 10^{-3}} = 8,85 \times 10^{-11} \, \text{F} = 88,5 \, \text{pF}$$</p>
                    
                    <p><strong>b) Tính điện tích và năng lượng:</strong></p>
                    <p>Điện tích: $Q = C \cdot U$</p>
                    <p class="formula">$$Q = 8,85 \times 10^{-11} \times 300 = 2,655 \times 10^{-8} \, \text{C}$$</p>
                    <p>Năng lượng: $W = \frac{1}{2} C U^2 = \frac{1}{2} Q U$</p>
                    <p class="formula">$$W = \frac{1}{2} \times 8,85 \times 10^{-11} \times 300^2 = 3,9825 \times 10^{-6} \, \text{J}$$</p>
                    
                    <p><strong>c) Khi ngắt khỏi nguồn và nhúng vào điện môi:</strong></p>
                    <p>Điện tích không đổi (ngắt khỏi nguồn): $Q' = Q = 2,655 \times 10^{-8} \, \text{C}$</p>
                    <p>Điện dung mới: $C' = \varepsilon C = 4 \times 8,85 \times 10^{-11} = 3,54 \times 10^{-10} \, \text{F}$</p>
                    <p>Hiệu điện thế mới: $U' = \frac{Q'}{C'} = \frac{2,655 \times 10^{-8}}{3,54 \times 10^{-10}} = 75 \, \text{V}$</p>
                    
                    <p><strong>Kết luận:</strong> 
                    a) $C = 88,5 \, \text{pF}$; 
                    b) $Q = 26,55 \, \text{nC}$, $W = 3,98 \, \mu\text{J}$; 
                    c) $C' = 354 \, \text{pF}$, $U' = 75 \, \text{V}$.</p>
                </div>
            </div>
            
            <!-- Bài tập tự luận 2 -->
            <div class="exercise">
                <div class="question-header">
                    <div class="question-title-container">
                        <div class="question-number-essay">2</div>
                        <h2 class="question-title">Ghép tụ điện nối tiếp và song song</h2>
                    </div>
                    <button class="toggle-solution-btn" data-target="solution-2">Hiển thị lời giải</button>
                </div>
                <div class="question-content">
                    Có ba tụ điện: $C_1 = 2 \, \mu\text{F}$, $C_2 = 4 \, \mu\text{F}$, $C_3 = 6 \, \mu\text{F}$.
                    a) Tính điện dung của bộ tụ khi ghép nối tiếp.
                    b) Tính điện dung của bộ tụ khi ghép song song.
                    c) Mắc bộ tụ ghép nối tiếp vào nguồn điện có hiệu điện thế $U = 120 \, \text{V}$. Tính hiệu điện thế và điện tích trên mỗi tụ.
                </div>
                <div class="summary">
                    <h3>Tóm tắt</h3>
                    <p>$C_1 = 2 \, \mu\text{F}$, $C_2 = 4 \, \mu\text{F}$, $C_3 = 6 \, \mu\text{F}$, $U = 120 \, \text{V}$.
                    Tính $C_{nt}$, $C_{ss}$, và với bộ nối tiếp: $U_1, U_2, U_3, Q$.</p>
                </div>
                <div class="solution hidden" id="solution-2">
                    <h3>Lời giải</h3>
                    <p><strong>a) Ghép nối tiếp:</strong></p>
                    <p class="formula">$$\frac{1}{C_{nt}} = \frac{1}{C_1} + \frac{1}{C_2} + \frac{1}{C_3} = \frac{1}{2} + \frac{1}{4} + \frac{1}{6} = \frac{6+3+2}{12} = \frac{11}{12}$$</p>
                    <p class="formula">$$C_{nt} = \frac{12}{11} \approx 1,091 \, \mu\text{F}$$</p>
                    
                    <p><strong>b) Ghép song song:</strong></p>
                    <p class="formula">$$C_{ss} = C_1 + C_2 + C_3 = 2 + 4 + 6 = 12 \, \mu\text{F}$$</p>
                    
                    <p><strong>c) Bộ nối tiếp mắc vào $U = 120 \, \text{V}$:</strong></p>
                    <p>Điện tích trên mỗi tụ bằng nhau (ghép nối tiếp): $Q = C_{nt} \cdot U$</p>
                    <p class="formula">$$Q = 1,091 \times 10^{-6} \times 120 \approx 1,309 \times 10^{-4} \, \text{C}$$</p>
                    <p>Hiệu điện thế trên mỗi tụ: $U_i = \frac{Q}{C_i}$</p>
                    <p class="formula">$$U_1 = \frac{1,309 \times 10^{-4}}{2 \times 10^{-6}} = 65,45 \, \text{V}$$</p>
                    <p class="formula">$$U_2 = \frac{1,309 \times 10^{-4}}{4 \times 10^{-6}} = 32,73 \, \text{V}$$</p>
                    <p class="formula">$$U_3 = \frac{1,309 \times 10^{-4}}{6 \times 10^{-6}} = 21,82 \, \text{V}$$</p>
                    <p>Kiểm tra: $U_1 + U_2 + U_3 = 65,45 + 32,73 + 21,82 = 120 \, \text{V}$ (đúng).</p>
                    
                    <p><strong>Kết luận:</strong> 
                    a) $C_{nt} \approx 1,09 \, \mu\text{F}$; 
                    b) $C_{ss} = 12 \, \mu\text{F}$; 
                    c) $Q \approx 130,9 \, \mu\text{C}$, $U_1 \approx 65,5 \, \text{V}$, $U_2 \approx 32,7 \, \text{V}$, $U_3 \approx 21,8 \, \text{V}$.</p>
                </div>
            </div>
            
            <!-- Bài tập tự luận 3 -->
            <div class="exercise">
                <div class="question-header">
                    <div class="question-title-container">
                        <div class="question-number-essay">3</div>
                        <h2 class="question-title">Tụ điện trong mạch RC</h2>
                    </div>
                    <button class="toggle-solution-btn" data-target="solution-3">Hiển thị lời giải</button>
                </div>
                <div class="question-content">
                    Một tụ điện có điện dung $C = 10 \, \mu\text{F}$ được tích điện đến hiệu điện thế $U_0 = 50 \, \text{V}$ qua điện trở $R = 100 \, \text{k}\Omega$.
                    a) Tính điện tích cực đại của tụ.
                    b) Tính năng lượng cực đại tích trữ trong tụ.
                    c) Sau khi tích điện đầy, ngắt tụ khỏi nguồn và cho phóng điện qua điện trở $R$. Tính thời gian để điện tích trên tụ giảm còn một nửa.
                </div>
                <div class="summary">
                    <h3>Tóm tắt</h3>
                    <p>$C = 10 \, \mu\text{F} = 10^{-5} \, \text{F}$, $U_0 = 50 \, \text{V}$, $R = 100 \, \text{k}\Omega = 10^5 \, \Omega$.
                    Tính $Q_0$, $W_0$, và $t$ khi $Q = Q_0/2$.</p>
                </div>
                <div class="solution hidden" id="solution-3">
                    <h3>Lời giải</h3>
                    <p><strong>a) Điện tích cực đại:</strong></p>
                    <p class="formula">$$Q_0 = C \cdot U_0 = 10^{-5} \times 50 = 5 \times 10^{-4} \, \text{C} = 500 \, \mu\text{C}$$</p>
                    
                    <p><strong>b) Năng lượng cực đại:</strong></p>
                    <p class="formula">$$W_0 = \frac{1}{2} C U_0^2 = \frac{1}{2} \times 10^{-5} \times 50^2 = 1,25 \times 10^{-2} \, \text{J} = 12,5 \, \text{mJ}$$</p>
                    
                    <p><strong>c) Thời gian để điện tích giảm còn một nửa:</strong></p>
                    <p>Khi phóng điện qua điện trở, điện tích giảm theo hàm mũ: $Q(t) = Q_0 e^{-t/(RC)}$</p>
                    <p>Khi $Q(t) = Q_0/2$, ta có: $\frac{Q_0}{2} = Q_0 e^{-t/(RC)} \Rightarrow e^{-t/(RC)} = \frac{1}{2}$</p>
                    <p class="formula">$$-\frac{t}{RC} = \ln\left(\frac{1}{2}\right) = -\ln 2$$</p>
                    <p class="formula">$$t = RC \ln 2 = 10^5 \times 10^{-5} \times \ln 2 = 1 \times 0,693 \approx 0,693 \, \text{s}$$</p>
                    
                    <p><strong>Kết luận:</strong> 
                    a) $Q_0 = 500 \, \mu\text{C}$; 
                    b) $W_0 = 12,5 \, \text{mJ}$; 
                    c) $t \approx 0,693 \, \text{s}$.</p>
                </div>
            </div>
            
            <!-- Bài tập tự luận 4 -->
            <div class="exercise">
                <div class="question-header">
                    <div class="question-title-container">
                        <div class="question-number-essay">4</div>
                        <h2 class="question-title">Tụ điện xoay chiều và ứng dụng</h2>
                    </div>
                    <button class="toggle-solution-btn" data-target="solution-4">Hiển thị lời giải</button>
                </div>
                <div class="question-content">
                    Một tụ điện có điện dung $C = 20 \, \mu\text{F}$ được mắc vào nguồn điện xoay chiều có điện áp hiệu dụng $U = 220 \, \text{V}$, tần số $f = 50 \, \text{Hz}$.
                    a) Tính dung kháng của tụ điện.
                    b) Tính cường độ dòng điện hiệu dụng qua tụ.
                    c) Nếu tần số tăng gấp đôi ($f' = 100 \, \text{Hz}$), dung kháng và dòng điện thay đổi thế nào?
                </div>
                <div class="summary">
                    <h3>Tóm tắt</h3>
                    <p>$C = 20 \, \mu\text{F} = 2 \times 10^{-5} \, \text{F}$, $U = 220 \, \text{V}$, $f = 50 \, \text{Hz}$.
                    Tính $Z_C$, $I$, và khi $f' = 100 \, \text{Hz}$.</p>
                </div>
                <div class="solution hidden" id="solution-4">
                    <h3>Lời giải</h3>
                    <p><strong>a) Dung kháng của tụ điện:</strong></p>
                    <p class="formula">$$Z_C = \frac{1}{2\pi f C} = \frac{1}{2\pi \times 50 \times 2 \times 10^{-5}} = \frac{1}{2\pi \times 10^{-3}} \approx 159,2 \, \Omega$$</p>
                    
                    <p><strong>b) Cường độ dòng điện hiệu dụng:</strong></p>
                    <p class="formula">$$I = \frac{U}{Z_C} = \frac{220}{159,2} \approx 1,382 \, \text{A}$$</p>
                    
                    <p><strong>c) Khi tần số tăng gấp đôi ($f' = 100 \, \text{Hz}$):</strong></p>
                    <p>Dung kháng mới: $Z_C' = \frac{1}{2\pi f' C} = \frac{Z_C}{2} \approx 79,6 \, \Omega$</p>
                    <p>Dòng điện mới: $I' = \frac{U}{Z_C'} = \frac{220}{79,6} \approx 2,764 \, \text{A}$</p>
                    <p>Vậy khi tần số tăng gấp đôi, dung kháng giảm một nửa và dòng điện tăng gấp đôi.</p>
                    
                    <p><strong>Kết luận:</strong> 
                    a) $Z_C \approx 159,2 \, \Omega$; 
                    b) $I \approx 1,38 \, \text{A}$; 
                    c) $Z_C' \approx 79,6 \, \Omega$, $I' \approx 2,76 \, \text{A}$.</p>
                </div>
            </div>
            
            <!-- Bài tập tự luận 5 -->
            <div class="exercise">
                <div class="question-header">
                    <div class="question-title-container">
                        <div class="question-number-essay">5</div>
                        <h2 class="question-title">Bài toán thực tế về tụ điện</h2>
                    </div>
                    <button class="toggle-solution-btn" data-target="solution-5">Hiển thị lời giải</button>
                </div>
                <div class="question-content">
                    Một tụ điện có thông số kỹ thuật: $C = 4700 \, \mu\text{F}$, $U_{\text{max}} = 25 \, \text{V}$.
                    a) Tính năng lượng tối đa có thể tích trữ trong tụ này.
                    b) Nếu dùng tụ này để cấp nguồn cho một đèn LED có công suất $P = 1 \, \text{W}$, hiệu điện thế hoạt động $U_{\text{LED}} = 3 \, \text{V}$, thì thời gian tối đa có thể thắp sáng đèn là bao lâu (giả sử hiệu suất 100%)?
                    c) Trong thực tế, tụ điện có thể phóng điện không hoàn toàn. Nếu hiệu suất phóng điện là 80%, tính thời gian thắp sáng thực tế.
                </div>
                <div class="summary">
                    <h3>Tóm tắt</h3>
                    <p>$C = 4700 \, \mu\text{F} = 4,7 \times 10^{-3} \, \text{F}$, $U_{\text{max}} = 25 \, \text{V}$, $P = 1 \, \text{W}$, $U_{\text{LED}} = 3 \, \text{V}$.
                    Tính $W_{\text{max}}$, $t_{\text{lý thuyết}}$, $t_{\text{thực tế}}$ với hiệu suất 80%.</p>
                </div>
                <div class="solution hidden" id="solution-5">
                    <h3>Lời giải</h3>
                    <p><strong>a) Năng lượng tối đa tích trữ:</strong></p>
                    <p class="formula">$$W_{\text{max}} = \frac{1}{2} C U_{\text{max}}^2 = \frac{1}{2} \times 4,7 \times 10^{-3} \times 25^2 = 1,46875 \, \text{J}$$</p>
                    
                    <p><strong>b) Thời gian thắp sáng lý thuyết:</strong></p>
                    <p>Đèn LED tiêu thụ công suất $P = 1 \, \text{W}$, năng lượng cần: $W = P \cdot t$</p>
                    <p class="formula">$$t_{\text{lý thuyết}} = \frac{W_{\text{max}}}{P} = \frac{1,46875}{1} = 1,46875 \, \text{s} \approx 1,47 \, \text{s}$$</p>
                    
                    <p><strong>c) Thời gian thắp sáng thực tế với hiệu suất 80%:</strong></p>
                    <p>Năng lượng thực tế có thể sử dụng: $W_{\text{thực}} = 0,8 \times W_{\text{max}} = 0,8 \times 1,46875 = 1,175 \, \text{J}$</p>
                    <p class="formula">$$t_{\text{thực tế}} = \frac{W_{\text{thực}}}{P} = \frac{1,175}{1} = 1,175 \, \text{s} \approx 1,18 \, \text{s}$$</p>
                    
                    <p><strong>Kết luận:</strong> 
                    a) $W_{\text{max}} \approx 1,47 \, \text{J}$; 
                    b) $t_{\text{lý thuyết}} \approx 1,47 \, \text{s}$; 
                    c) $t_{\text{thực tế}} \approx 1,18 \, \text{s}$.</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Bài tập Vật Lý 11 - Bài 21: Tụ Điện | Trắc nghiệm và Tự luận</p>
        </footer>
    </div>

    <script>
        // Dữ liệu câu hỏi trắc nghiệm (20 câu)
        const quizData = [
            {
                question: "Đơn vị của điện dung trong hệ SI là:",
                options: [
                    "A. Culông (C).",
                    "B. Fara (F).",
                    "C. Vôn (V).",
                    "D. Jun (J)."
                ],
                correct: 1,
                explanation: "Điện dung có đơn vị là Fara (F), đặt theo tên nhà vật lý Michael Faraday."
            },
            {
                question: "Công thức tính điện dung của tụ điện phẳng là:",
                options: [
                    "A. $C = \\frac{\\varepsilon S}{4\\pi k d}$.",
                    "B. $C = \\frac{\\varepsilon_0 S}{d}$.",
                    "C. $C = \\frac{Q}{U}$.",
                    "D. Cả A, B và C đều đúng."
                ],
                correct: 3,
                explanation: "Cả ba công thức đều đúng: A là dạng với hằng số k, B là dạng với ε₀, C là định nghĩa điện dung."
            },
            {
                question: "Khi ghép n tụ điện giống nhau có điện dung C song song, điện dung của bộ tụ là:",
                options: [
                    "A. $C_b = nC$.",
                    "B. $C_b = \\frac{C}{n}$.",
                    "C. $C_b = C$.",
                    "D. $C_b = \\sqrt{n}C$."
                ],
                correct: 0,
                explanation: "Khi ghép song song, điện dung bộ tụ bằng tổng điện dung các tụ thành phần: $C_b = C_1 + C_2 + ... + C_n = nC$."
            },
            {
                question: "Một tụ điện có ghi 10μF - 450V. Điều này có nghĩa là:",
                options: [
                    "A. Điện dung tối đa là 10μF, điện áp tối đa là 450V.",
                    "B. Điện dung danh định là 10μF, điện áp làm việc tối đa là 450V.",
                    "C. Điện tích tối đa là 10μC, hiệu điện thế tối đa là 450V.",
                    "D. Công suất tối đa là 10W, điện áp 450V."
                ],
                correct: 1,
                explanation: "10μF là điện dung danh định, 450V là điện áp làm việc tối đa có thể đặt vào tụ mà không làm hỏng tụ."
            },
            {
                question: "Năng lượng của tụ điện được tính bằng công thức:",
                options: [
                    "A. $W = \\frac{1}{2}CU^2$.",
                    "B. $W = \\frac{1}{2}QU$.",
                    "C. $W = \\frac{Q^2}{2C}$.",
                    "D. Cả ba công thức trên."
                ],
                correct: 3,
                explanation: "Cả ba công thức đều đúng và có thể suy ra từ nhau thông qua $Q = CU$."
            },
            {
                question: "Khi tăng khoảng cách giữa hai bản tụ điện phẳng đã được tích điện và ngắt khỏi nguồn thì:",
                options: [
                    "A. Điện dung tăng, hiệu điện thế giảm.",
                    "B. Điện dung giảm, hiệu điện thế tăng.",
                    "C. Điện dung tăng, điện tích giảm.",
                    "D. Điện dung giảm, điện tích tăng."
                ],
                correct: 1,
                explanation: "Khi ngắt khỏi nguồn, điện tích Q không đổi. Điện dung $C = \\frac{\\varepsilon_0 S}{d}$ giảm khi d tăng. Từ $U = \\frac{Q}{C}$, U tăng."
            },
            {
                question: "Tụ điện có tác dụng:",
                options: [
                    "A. Ngăn cản dòng điện một chiều.",
                    "B. Cho dòng điện xoay chiều đi qua.",
                    "C. Tích trữ năng lượng điện trường.",
                    "D. Cả ba đáp án trên."
                ],
                correct: 3,
                explanation: "Tụ điện có cả ba tác dụng: ngăn dòng một chiều, cho dòng xoay chiều đi qua, và tích trữ năng lượng điện trường."
            },
            {
                question: "Để có bộ tụ điện có điện dung lớn hơn điện dung của các tụ thành phần, ta phải ghép các tụ:",
                options: [
                    "A. Nối tiếp.",
                    "B. Song song.",
                    "C. Hỗn hợp.",
                    "D. Cả ba cách đều được."
                ],
                correct: 1,
                explanation: "Ghép song song làm tăng điện dung của bộ tụ: $C_b = C_1 + C_2 + ...$."
            },
            {
                question: "Một tụ điện có điện dung 2μF được tích điện dưới hiệu điện thế 10V. Điện tích của tụ là:",
                options: [
                    "A. 0,2μC.",
                    "B. 2μC.",
                    "C. 20μC.",
                    "D. 200μC."
                ],
                correct: 2,
                explanation: "$Q = CU = 2 \\times 10^{-6} \\times 10 = 20 \\times 10^{-6} C = 20 \\mu C$."
            },
            {
                question: "Hai tụ điện có điện dung $C_1 = 3\\mu F$ và $C_2 = 6\\mu F$ ghép nối tiếp. Điện dung của bộ tụ là:",
                options: [
                    "A. 9μF.",
                    "B. 2μF.",
                    "C. 3μF.",
                    "D. 18μF."
                ],
                correct: 1,
                explanation: "Ghép nối tiếp: $\\frac{1}{C} = \\frac{1}{C_1} + \\frac{1}{C_2} = \\frac{1}{3} + \\frac{1}{6} = \\frac{1}{2}$, suy ra $C = 2\\mu F$."
            },
            {
                question: "Trong công thức tính năng lượng tụ điện $W = \\frac{1}{2}CU^2$, nếu tăng hiệu điện thế U lên 2 lần thì năng lượng:",
                options: [
                    "A. Tăng 2 lần.",
                    "B. Tăng 4 lần.",
                    "C. Giảm 2 lần.",
                    "D. Không đổi."
                ],
                correct: 1,
                explanation: "Năng lượng tỉ lệ với bình phương hiệu điện thế: $W \\sim U^2$, nên khi U tăng 2 lần thì W tăng 4 lần."
            },
            {
                question: "Một tụ điện phẳng không khí, nếu đưa vào giữa hai bản một tấm điện môi thì điện dung sẽ:",
                options: [
                    "A. Tăng lên.",
                    "B. Giảm đi.",
                    "C. Không đổi.",
                    "D. Có thể tăng hoặc giảm."
                ],
                correct: 0,
                explanation: "Điện dung tỉ lệ với hằng số điện môi ε. Điện môi có ε > 1 nên điện dung tăng."
            },
            {
                question: "Khi nói về tụ điện, phát biểu nào sau đây là sai?",
                options: [
                    "A. Tụ điện là hệ thống gồm hai vật dẫn đặt gần nhau và ngăn cách bằng lớp điện môi.",
                    "B. Điện dung của tụ điện đặc trưng cho khả năng tích điện của tụ.",
                    "C. Tụ điện chỉ cho dòng điện một chiều đi qua.",
                    "D. Tụ điện có thể tích trữ năng lượng dưới dạng năng lượng điện trường."
                ],
                correct: 2,
                explanation: "Tụ điện không cho dòng điện một chiều đi qua, chỉ cho dòng điện xoay chiều đi qua."
            },
            {
                question: "Khi ghép hai tụ điện song song vào nguồn điện một chiều thì:",
                options: [
                    "A. Điện tích trên các tụ bằng nhau.",
                    "B. Hiệu điện thế trên các tụ bằng nhau.",
                    "C. Năng lượng trên các tụ bằng nhau.",
                    "D. Điện dung của các tụ bằng nhau."
                ],
                correct: 1,
                explanation: "Khi ghép song song, hiệu điện thế trên các tụ bằng nhau và bằng hiệu điện thế của nguồn."
            },
            {
                question: "Một tụ điện có điện dung C được tích điện đến hiệu điện thế U. Sau đó ngắt tụ khỏi nguồn và nối hai bản tụ với nhau bằng một dây dẫn. Kết quả là:",
                options: [
                    "A. Tụ vẫn giữ nguyên điện tích.",
                    "B. Tụ phóng điện và điện tích giảm về 0.",
                    "C. Điện tích tăng lên gấp đôi.",
                    "D. Hiệu điện thế tăng lên."
                ],
                correct: 1,
                explanation: "Khi nối hai bản tụ bằng dây dẫn, tụ sẽ phóng điện và điện tích sẽ giảm về 0."
            },
            {
                question: "Tụ điện trong mạch điện xoay chiều có tác dụng:",
                options: [
                    "A. Làm lệch pha giữa dòng điện và điện áp.",
                    "B. Tích trữ năng lượng và trao đổi năng lượng với mạch.",
                    "C. Ngăn chặn thành phần một chiều.",
                    "D. Cả ba đáp án trên."
                ],
                correct: 3,
                explanation: "Tụ điện trong mạch xoay chiều có cả ba tác dụng: làm lệch pha, tích trữ năng lượng và ngăn chặn dòng một chiều."
            },
            {
                question: "Hai tụ điện $C_1 = 1\\mu F$ và $C_2 = 2\\mu F$ được ghép song song và mắc vào nguồn 6V. Điện tích trên tụ $C_1$ là:",
                options: [
                    "A. 1μC.",
                    "B. 2μC.",
                    "C. 6μC.",
                    "D. 12μC."
                ],
                correct: 2,
                explanation: "Khi ghép song song: $U_1 = U_2 = 6V$. $Q_1 = C_1U_1 = 1\\times 10^{-6} \\times 6 = 6\\times 10^{-6}C = 6\\mu C$."
            },
            {
                question: "Điện dung của tụ điện phẳng phụ thuộc vào:",
                options: [
                    "A. Diện tích đối diện của hai bản.",
                    "B. Khoảng cách giữa hai bản.",
                    "C. Bản chất của chất điện môi giữa hai bản.",
                    "D. Cả ba yếu tố trên."
                ],
                correct: 3,
                explanation: "Điện dung tụ điện phẳng phụ thuộc vào diện tích bản, khoảng cách và hằng số điện môi: $C = \\frac{\\varepsilon S}{d}$."
            },
            {
                question: "Khi tăng diện tích các bản tụ điện phẳng lên 3 lần, giữ nguyên khoảng cách và điện môi, thì điện dung:",
                options: [
                    "A. Tăng 3 lần.",
                    "B. Giảm 3 lần.",
                    "C. Không đổi.",
                    "D. Tăng 9 lần."
                ],
                correct: 0,
                explanation: "Điện dung tỉ lệ thuận với diện tích bản: $C \\sim S$, nên khi S tăng 3 lần thì C tăng 3 lần."
            },
            {
                question: "Một tụ điện có điện dung 100μF được tích điện dưới hiệu điện thế 50V. Năng lượng tích trữ trong tụ là:",
                options: [
                    "A. 0,125J.",
                    "B. 0,25J.",
                    "C. 0,5J.",
                    "D. 1,0J."
                ],
                correct: 0,
                explanation: "$W = \\frac{1}{2}CU^2 = \\frac{1}{2} \\times 100 \\times 10^{-6} \\times 50^2 = 0,125J$."
            }
        ];

        // Khởi tạo biến cho phần trắc nghiệm
        let userAnswers = new Array(quizData.length).fill(-1);
        let quizSubmitted = false;

        // Hiển thị các câu hỏi trắc nghiệm
        function renderQuiz() {
            const quizContainer = document.getElementById('quizContainer');
            quizContainer.innerHTML = '';
            
            quizData.forEach((item, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                
                let questionHTML = `
                    <div class="question-number">${index + 1}</div>
                    <div class="question-text">${item.question}</div>
                `;
                
                questionHTML += `<div class="options">`;
                
                item.options.forEach((option, optionIndex) => {
                    const isSelected = userAnswers[index] === optionIndex;
                    let optionClass = 'option';
                    if (isSelected) optionClass += ' selected';
                    if (quizSubmitted) {
                        if (optionIndex === item.correct) {
                            optionClass += ' correct';
                        } else if (isSelected && optionIndex !== item.correct) {
                            optionClass += ' incorrect';
                        }
                    }
                    
                    questionHTML += `
                        <div class="${optionClass}" data-question="${index}" data-option="${optionIndex}">
                            <div class="option-label">${String.fromCharCode(65 + optionIndex)}</div>
                            <div class="option-text">${option}</div>
                        </div>
                    `;
                });
                
                questionHTML += `</div>`;
                questionCard.innerHTML = questionHTML;
                quizContainer.appendChild(questionCard);
            });
            
            // Thêm sự kiện click cho các lựa chọn
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    if (quizSubmitted) return;
                    
                    const questionIndex = parseInt(this.dataset.question);
                    const optionIndex = parseInt(this.dataset.option);
                    
                    // Chỉ cho phép chọn 1 đáp án cho mỗi câu hỏi
                    userAnswers[questionIndex] = optionIndex;
                    
                    // Cập nhật giao diện
                    renderQuiz();
                });
            });
        }

        // Xử lý nộp bài trắc nghiệm
        document.getElementById('submitQuizBtn').addEventListener('click', function() {
            // Kiểm tra xem đã trả lời hết tất cả câu hỏi chưa
            const unanswered = userAnswers.filter(answer => answer === -1).length;
            if (unanswered > 0) {
                if (!confirm(`Bạn còn ${unanswered} câu chưa trả lời. Bạn có chắc chắn muốn nộp bài không?`)) {
                    return;
                }
            }
            
            quizSubmitted = true;
            
            // Tính điểm
            let score = 0;
            quizData.forEach((item, index) => {
                if (userAnswers[index] === item.correct) {
                    score++;
                }
            });
            
            // Hiển thị kết quả
            const resultContainer = document.getElementById('quizResultContainer');
            const scoreElement = document.getElementById('quizScore');
            const resultText = document.getElementById('quizResultText');
            const feedback = document.getElementById('quizFeedback');
            
            scoreElement.textContent = `${score}/${quizData.length}`;
            
            let percentage = (score / quizData.length) * 100;
            let resultMessage = '';
            
            if (percentage >= 90) {
                resultMessage = 'Xuất sắc! Bạn đã nắm vững kiến thức về tụ điện.';
            } else if (percentage >= 70) {
                resultMessage = 'Tốt! Bạn hiểu khá rõ về tụ điện.';
            } else if (percentage >= 50) {
                resultMessage = 'Khá! Bạn cần ôn tập thêm một số phần.';
            } else {
                resultMessage = 'Cần cố gắng hơn! Hãy xem lại lý thuyết về tụ điện.';
            }
            
            resultText.innerHTML = `<p><strong>${resultMessage}</strong></p>`;
            
            // Tạo feedback chi tiết
            let feedbackHTML = '<p><strong>Chi tiết các câu trả lời:</strong></p><ul>';
            quizData.forEach((item, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === item.correct;
                const userAnswerText = userAnswer === -1 ? 'Không trả lời' : item.options[userAnswer];
                const correctAnswerText = item.options[item.correct];
                
                feedbackHTML += `<li><strong>Câu ${index + 1}:</strong> `;
                
                if (userAnswer === -1) {
                    feedbackHTML += `<span style="color: #000000;">Bạn chưa trả lời</span>`;
                } else if (isCorrect) {
                    feedbackHTML += `<span style="color: #000000; font-weight: bold;">Đúng</span>`;
                } else {
                    feedbackHTML += `<span style="color: #000000;">Sai</span>`;
                }
                
                feedbackHTML += `<br>Đáp án của bạn: ${userAnswerText}`;
                feedbackHTML += `<br>Đáp án đúng: ${correctAnswerText}`;
                feedbackHTML += `<br>Giải thích: ${item.explanation}</li>`;
            });
            
            feedbackHTML += '</ul>';
            feedback.innerHTML = feedbackHTML;
            
            // Hiển thị container kết quả
            resultContainer.style.display = 'block';
            
            // Cuộn đến kết quả
            resultContainer.scrollIntoView({ behavior: 'smooth' });
            
            // Vô hiệu hóa nút nộp bài
            this.disabled = true;
        });

        // Xử lý làm lại trắc nghiệm
        document.getElementById('resetQuizBtn').addEventListener('click', function() {
            if (quizSubmitted) {
                if (!confirm('Bạn có chắc chắn muốn làm lại bài không? Kết quả hiện tại sẽ bị mất.')) {
                    return;
                }
            }
            
            userAnswers.fill(-1);
            quizSubmitted = false;
            renderQuiz();
            
            // Ẩn kết quả
            document.getElementById('quizResultContainer').style.display = 'none';
            
            // Kích hoạt lại nút nộp bài
            document.getElementById('submitQuizBtn').disabled = false;
        });

        // Xử lý tab điều hướng
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', function() {
                // Xóa lớp active từ tất cả các nút và nội dung
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Thêm lớp active cho nút được nhấn
                this.classList.add('active');
                
                // Hiển thị nội dung tương ứng
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Xử lý phần tự luận
        document.addEventListener('DOMContentLoaded', function() {
            // Lấy tất cả các nút ẩn/hiện lời giải
            const toggleButtons = document.querySelectorAll('.toggle-solution-btn');
            
            // Gán sự kiện cho từng nút
            toggleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const solution = document.getElementById(targetId);
                    
                    if (solution.classList.contains('hidden')) {
                        solution.classList.remove('hidden');
                        this.textContent = 'Ẩn lời giải';
                    } else {
                        solution.classList.add('hidden');
                        this.textContent = 'Hiển thị lời giải';
                    }
                    
                    // Render lại MathJax khi toggle
                    refreshMathJax();
                });
            });
            
            // Nút hiển thị tất cả lời giải
            const showAllBtn = document.getElementById('showAllSolutionsBtn');
            showAllBtn.addEventListener('click', function() {
                toggleButtons.forEach(button => {
                    const targetId = button.getAttribute('data-target');
                    const solution = document.getElementById(targetId);
                    solution.classList.remove('hidden');
                    button.textContent = 'Ẩn lời giải';
                });
                refreshMathJax();
            });
            
            // Nút ẩn tất cả lời giải
            const hideAllBtn = document.getElementById('hideAllSolutionsBtn');
            hideAllBtn.addEventListener('click', function() {
                toggleButtons.forEach(button => {
                    const targetId = button.getAttribute('data-target');
                    const solution = document.getElementById(targetId);
                    solution.classList.add('hidden');
                    button.textContent = 'Hiển thị lời giải';
                });
            });
            
            // Khởi tạo lại MathJax sau khi hiển thị lời giải
            function refreshMathJax() {
                if (window.MathJax) {
                    MathJax.typesetPromise();
                }
            }
            
            // Khởi tạo MathJax
            setTimeout(refreshMathJax, 500);
            
            // Khởi tạo quiz
            renderQuiz();
        });
    </script>
</body>
</html>